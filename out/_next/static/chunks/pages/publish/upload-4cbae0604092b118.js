(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[692],{7360:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/publish/upload",function(){return a(7549)}])},7549:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var n=a(5893),i=a(7294),c=a(7536),s=a(7228),l=a(3554),r=a.n(l),o=a(2768);function u(e){let{tab:t}=e,{register:a,handleSubmit:l,setFocus:u,reset:_,setValue:d}=(0,c.cI)(),{fileSrc:h,setFileSrc:p,fileName:m,setFileName:f,isClearUpload:g,setIsClearUpload:x,isSubmit:y,createClipAsync:b,handleFile:j,onCreate:C}=(0,o.Z)(),v=e=>{2===e.target.value.length&&u("month"),e.target.value.length>2&&(e.target.value=e.target.value.slice(0,2))},N=e=>{2===e.target.value.length&&u("year"),e.target.value.length>2&&(e.target.value=e.target.value.slice(0,2))},w=e=>{e.target.value.length>4&&(e.target.value=e.target.value.slice(0,4))};return(0,i.useEffect)(()=>{g&&(_(),p(""),f("Выберите файл"),x(!1),d("cypher",localStorage.getItem("cypher")))},[g]),(0,i.useEffect)(()=>{d("cypher",localStorage.getItem("cypher")),u("name")},[]),(0,n.jsx)(s.Z,{tab:t,title:"Загрузка видео",children:(0,n.jsxs)("form",{className:r().form,onSubmit:l(C),encType:"multipart/form-data",children:[(0,n.jsxs)("label",{className:r().field,children:[(0,n.jsx)("h4",{className:r().field__title,children:"Название"}),(0,n.jsx)("input",{...a("name"),type:"text",autoComplete:"off"})]}),(0,n.jsxs)("div",{className:r().period,children:[(0,n.jsx)("h4",{className:r().field__title,children:"Период действия"}),(0,n.jsx)("input",{...a("day"),type:"text",onChange:e=>v(e),autoComplete:"off"}),(0,n.jsx)("input",{...a("month"),type:"text",onChange:e=>N(e),autoComplete:"off"}),(0,n.jsx)("input",{...a("year"),type:"text",onChange:e=>w(e),autoComplete:"off"})]}),(0,n.jsxs)("label",{className:r().media,onChange:e=>j(e),children:[(0,n.jsx)("input",{...a("media"),type:"file"}),(0,n.jsx)("h4",{className:r().field__title,children:"Видео-файл"}),(0,n.jsxs)("div",{className:r().media__container,children:[(0,n.jsx)("div",{className:r().media__image,children:(0,n.jsx)("video",{src:h})}),(0,n.jsx)("div",{className:r().media__caption,children:(0,n.jsx)("span",{className:r().media__fileName,children:m})})]})]}),(0,n.jsxs)("label",{className:r().field,children:[(0,n.jsx)("h4",{className:r().field__title,children:"Кодовая фраза"}),(0,n.jsx)("input",{...a("cypher"),type:"text",autoComplete:"off"})]}),(0,n.jsx)("button",{className:r().submit,disabled:y,children:"Отправить"})]})})}function _(){return(0,n.jsx)(u,{tab:"Upload | Publish ITMFC"})}},2933:function(e,t,a){"use strict";a.d(t,{L:function(){return n}});let n="https://api.itmfc.ru/api"},9682:function(e,t,a){"use strict";a.d(t,{n:function(){return s}});var n=a(7066),i=a(2933);let c="".concat(i.L,"/publish"),s={getAllClips:async()=>n.Z.get("".concat(c,"/")).then(e=>e).catch(e=>e.response),getAllClipsShuffle:async()=>n.Z.get("".concat(c,"/shuffle")).then(e=>e).catch(e=>e.response),getClip:async e=>n.Z.get("".concat(c,"/clip/").concat(e)).then(e=>e).catch(e=>e.response),createClip:async e=>n.Z.post("".concat(c,"/"),e,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>e).catch(e=>e.response),editClip:async(e,t)=>n.Z.put("".concat(c,"/clip/").concat(e),t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>e).catch(e=>e.response),removeClip:async e=>n.Z.delete("".concat(c,"/clip/").concat(e)).then(e=>e).catch(e=>e.response),checkNonstopClip:async e=>n.Z.get("".concat(c,"/nonstop/").concat(e)).then(e=>e).catch(e=>e.response),wrongClip:async e=>n.Z.put("".concat(c,"/clip/").concat(e,"/wrong")).then(e=>e).catch(e=>e.response),checkLocalClip:async e=>n.Z.get("http://localhost:3000/api/clip/".concat(e)).then(e=>e).catch(e=>e.response)}},7228:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var n=a(5893),i=a(4991),c=a(463),s=a.n(c);function l(e){let{children:t,tab:a,title:c=""}=e;return(0,n.jsx)(i.Z,{tab:a,children:(0,n.jsxs)("div",{className:s().wrapper,children:[(0,n.jsx)("picture",{className:s().logo}),c&&(0,n.jsx)("h1",{className:s().mainTitle,children:c}),t]})})}},4991:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var n=a(5893),i=a(9008),c=a.n(i);function s(e){let{children:t,tab:a}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c(),{children:[(0,n.jsx)("title",{children:a}),(0,n.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),t]})}},2768:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var n=a(7294),i=a(8767),c=a(6938),s=a(9682);let l=e=>e&&e.status>=200&&e.status<300;function r(){let[e,t]=(0,n.useState)(""),[a,r]=(0,n.useState)("Выберите файл"),[o,u]=(0,n.useState)(!1),[_,d]=(0,n.useState)(!1),{mutateAsync:h}=(0,i.useMutation)("create clip publish",e=>s.n.createClip(e).then(e=>{l(e)?(c.Rt.success("Успешно","Клип загружен на сервер."),u(!0)):(c.Rt.error("Неудача","Что-то пошло не так..."),console.log(e)),d(!1)}));return{fileSrc:e,setFileSrc:t,fileName:a,setFileName:r,isClearUpload:o,setIsClearUpload:u,isSubmit:_,createClipAsync:h,handleFile:e=>{let a=e.target.files[0],n=new FileReader;n.onloadend=e=>{t(e.target.result)},a&&(n.readAsDataURL(a),r(e.target.value.split("\\").pop()))},downloadFile:(e,t,a)=>{let n=new Blob([e],{type:a}),i=document.createElement("a");i.href=URL.createObjectURL(n),i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i)},onCreate:e=>{localStorage.setItem("cypher",e.cypher),e={...e,expiration_date:"".concat(e.year,"-").concat(e.month,"-").concat(e.day),media:e.media[0]},d(!0),h(e)}}}},463:function(e){e.exports={wrapper:"Layout_wrapper__zO2CQ",mainTitle:"Layout_mainTitle__rEH5U"}},3554:function(e){e.exports={stream__container:"Publish_stream__container__4tZ05",stream__clip:"Publish_stream__clip__8El2u",stream__logo:"Publish_stream__logo__e9rV_",stream__logo_show:"Publish_stream__logo_show__Tg8Zk",form:"Publish_form__PW_Ue",field:"Publish_field__G5jWU",field__title:"Publish_field__title__g6_UW",period:"Publish_period__Zm5qn",media:"Publish_media__Jm_Yq",media__container:"Publish_media__container__GhXkF",media__caption:"Publish_media__caption__xXys8",media__image:"Publish_media__image__Gkmn6",media__fileName:"Publish_media__fileName__MewTM",submit:"Publish_submit___dPcy"}}},function(e){e.O(0,[703,536,888,774,179],function(){return e(e.s=7360)}),_N_E=e.O()}]);